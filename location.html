<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
  
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
  <script type="text/javascript" src="./assets/js/highlight.pack.js"></script>
  
  <script type="text/javascript" src="./assets/js/jquery_rotate.js"></script>
  <script type="text/javascript" src="./assets/js/main.js"></script>
  <script type="text/javascript" src="./assets/js/popover.js"></script>
  
  <script>
    
$(function(){

	// select the tab in the sidebar to reflect current page position

	var tabName = "Location";

	$('.nav-link.active').removeClass('active');
	console.log('active tab: ', tabName);
	var nav_link = $('.nav-link:contains("' + tabName + '")');
	console.log('actual nav link:', nav_link);
	nav_link.addClass('active');
	
});
  </script>


  <script>
  $(document).ready(function(){
      $('[data-toggle="popover"]').popover(); 
  });

  /* Close all the other popovers */
  $('html').on('mouseup', function(e) {
      if(!$(e.target).closest('.popover').length) {
          $('.popover').each(function(){
              $(this.previousSibling).popover('hide');
          });
      }
  });

  </script>
  
  <script>hljs.initHighlightingOnLoad();</script>


  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="./assets/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="./assets/css/bvbootstrap.css">
  <link rel="stylesheet" type="text/css" href="./assets/css/highlightjs/default.min.css">
  <link rel="stylesheet" type="text/css" href="./assets/css/main.css">

  
  <link rel="apple-touch-icon-precomposed" sizes="57x57" href="./public/apple-touch-icon-57x57.png" />
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="./public/apple-touch-icon-114x114.png" />
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="./public/apple-touch-icon-72x72.png" />
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="./public/apple-touch-icon-144x144.png" />
  <link rel="apple-touch-icon-precomposed" sizes="60x60" href="./public/apple-touch-icon-60x60.png" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="./public/apple-touch-icon-120x120.png" />
  <link rel="apple-touch-icon-precomposed" sizes="76x76" href="./public/apple-touch-icon-76x76.png" />
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="./public/apple-touch-icon-152x152.png" />
  <link rel="icon" type="image/png" href="./public/favicon-196x196.png" sizes="196x196" />
  <link rel="icon" type="image/png" href="./public/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/png" href="./public/favicon-32x32.png" sizes="32x32" />
  <link rel="icon" type="image/png" href="./public/favicon-16x16.png" sizes="16x16" />
  <link rel="icon" type="image/png" href="./public/favicon-128.png" sizes="128x128" />
  <meta name="application-name" content="&nbsp;"/>
  <meta name="msapplication-TileColor" content="#FFFFFF" />
  <meta name="msapplication-TileImage" content="./public/mstile-144x144.png" />
  <meta name="msapplication-square70x70logo" content="./public/mstile-70x70.png" />
  <meta name="msapplication-square150x150logo" content="./public/mstile-150x150.png" />

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', UA-56370630-5, 'auto');
    ga('set', {
      title: 'Location'
    });
    ga('send', 'pageview');
  </script>

</head>


  <body>
    <div id="portal_container">
      
      <nav class="navbar-fixed-top">
    <div class="navbar-header">
        <div class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1"
             aria-expanded="false">
            <i class="fa fa-bars fa-3"
               style="color:#fffff5; background-color: #00AB8E; padding:7px; border-radius: 3px;"></i>

            <a href="/" class="bv_logo" style="font-size: 22px;">
                <span class="bv_teal">&nbsp;bazaar</span><span class="bv_white">voice</span><span
                    class="bv_teal">:</span>
            </a>
        </div>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav side-nav nav-stacked nav-pills">
            <div class="bv_logo">
                <a href="/bv-android-sdk/index.html">
                    <span class="bv_teal">bazaar</span><span class="bv_white">voice</span><span class="bv_teal">:</span>
                </a>
            </div>
            <li class="nav-item">
                <a class="nav-link active" href="index.html">
                    <span><i class="m-r-1 fa fa-file-text-o"></i>Getting Started</span>
                </a>
                <ul>
                    <li class="nav-item">
                        <a class="nav-link" href="requirements.html">
                            <span>Requirements</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="installation.html">
                            <span>Installation and Configuration</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="example_projects.html">
                            <span>Example Projects</span>
                        </a>
                    </li>
                </ul>
            </li>
            <li class="nav-item">
                <span class="nav-link" href="modules.html">
                    <span><i class="m-r-1 fa fa-cogs"></i>Modules</span>
                </span>
                <ul>

                    
                    <!-- BV Pixel -->
					<li class="nav-item">
                                    <a class="nav-link" href="bvpixel_implementation.html"><span>BV Pixel</span></a>
                                </li>

                     <!-- Conversations -->
                    <li class="nav-item">
                        <a class="nav-link" role="button" data-toggle="collapse" href="#conversationsDropdown"
                           aria-expanded="false" aria-controls="conversationsDropdown">
                                <span><span>Conversations</span><span style="float:right;"><i
                                        id="conversationsDropdownArrow"
                                        class="fa fa-sort-desc fa-rotate-270"></i></span></span>
                        </a>
                        <div class="collapse "
                             id="conversationsDropdown">
                            <ul>
                                <li class="nav-item"> 
                                    <a class="nav-link" href="conversations_display.html"><span>Content Display</span></a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="conversations_submission.html"><span>Content Submission</span></a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="conversations_authentication.html"><span>Authentication</span></a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="conversations_iovation.html"><span>Authenticity with iovation</span></a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="conversations_badges.html"><span>Badges</span></a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="conversations_multi_config.html"><span>Multi Config</span></a>
                                </li>
                            </ul>
                        </div>

                    </li>

                    <!-- Curations -->
                    <li class="nav-item">
                        <a class="nav-link" role="button" data-toggle="collapse" href="#curationsDropdown"
                           aria-expanded="false" aria-controls="curationsDropdown">
                                <span><span>Curations</span><span style="float:right;">
                                    <i id="curationsDropdownArrow" class="fa fa-sort-desc  fa-rotate-270"></i>
                                </span></span>
                        </a>
                        <div class="collapse "
                             id="curationsDropdown">
                            <ul>
                                <li class="nav-item">
                                    <a class="nav-link" href="curations_display.html"><span>Curations Display</span></a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="curations_custom_posts.html"><span>Curations Custom Posts</span></a>
                                </li>
                            </ul>
                        </div>
                    </li>

                    <!-- Product Recommendations -->
                    <li class="nav-item">
                        <a class="nav-link" href="product_recommendations.html"><span>Product Recommendations (Beta)</span></a>
                    </li>
                    
                    <!-- Advertising -->
                    <li class="nav-item">
                        <a class="nav-link" href="advertising.html"><span>Advertising</span></a>
                    </li>

                    
                    <!-- Ratings Reviews Stores -->
                     <li class="nav-item">
                        <a class="nav-link" role="button" data-toggle="collapse" href="#conversationsStoresDropdown"
                           aria-expanded="false" aria-controls="conversationsStoresDropdown">
                                <span><span>Ratings and Reviews for Stores</span><span style="float:right;"><i
                                        id="conversationsStoresDropdownArrow"
                                        class="fa fa-sort-desc fa-rotate-270"></i></span></span>
                        </a>
                        <div class="collapse "
                             id="conversationsStoresDropdown">
                            <ul>
                                <li class="nav-item">
                                    <a class="nav-link" href="conversations_stores.html"><span>Display and Submit API</span></a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="conversations_stores_push.html"><span>Stores Push Notifications</span></a>
                                </li>
                            </ul>
                        </div>
                    </li>
                    
                    <!-- PIN -->
                    <li class="nav-item">
                        <a class="nav-link" href="pin.html"><span>Post Interaction Notifications (Beta)</span></a>
                    </li>

                    <!-- Location -->
                    <li class="nav-item">
                        <a class="nav-link" href="location.html"><span>Location (Beta)</span></a>
                    </li>

                </ul>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="user_authentication_token.html">
                    <span><i class="m-r-1 fa fa-lock"></i>User Authentication Token</span>
                </a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="faq_support.html">
                    <span><i class="m-r-1 fa fa-question-circle"></i>FAQ and Support</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="api_reference.html">
                    <span><i class="m-r-1 fa fa-book"></i>API Reference</span>
                </a>
            </li>
            <br>
            <li class="nav-item">
                <a class="nav-link"
                   href="mailto:mobilecoreteam@bazaarvoice.com?subject=Android SDK documentation feedback"
                   style="border: 1px #fff solid;">
                    <span><i class="m-r-1 fa fa-envelope"></i>Feedback</span>
                </a>
            </li>
        </ul>
    </div>
</nav>

      <div id="application_container">
        <div id="task_container">
          <div id="task_content" class="app-content">
            <div class="scroll-container scrollable--scrollbar">
              <div class="page-container">

                <div class="flex flex-row" id="content_title">
	Location
</div>

<p class="bg-info well-lg" style="padding:4px;"><i class="fa fa-hand-o-right"></i>  The Location module is currently in limited beta release. If you'd like to participate, please contact Bazaarvoice.</p>

<p>The Location module of the Bazaarvoice Mobile SDK facilitates knowing when your shoppers are entering and exiting your physical retail locations. You will be provided a very valuable opportunity to present a shopper with your location aware content. Perhaps you have a simple greeting or coupon? Aside from the value you add within your mobile experience, Bazaarvoice can use this location context to enhance our existing products. Rating and Reviews filtered down to the city level, recommended products for nearby people like you, local social media content (Curations), and more are all possible by using the Location module.</p>


<p class="bg-info well-lg" style="padding:4px;"><i class="fa fa-hand-o-right"></i>  You must have Bazaarvoice Location enabled to use the Location module. Contact Bazaarvoice to set up Location and to get your <strong>apiKeyLocation</strong>.</p>

<hr/>
<br>




<div class="panel panel-default">
  <div class="panel-heading" role="tab" id="heading-installationCollapse">
    <a role="button" data-toggle="collapse" data-parent="#accordion" href="#installationCollapse" aria-expanded="false" aria-controls="installationCollapse" style="text-decoration: none">
      <div class="flex flex-row" style="align-items: center; padding-bottom: 10px;">
          <i id="installationArrow" class="fa fa-chevron-right" style="color:#777; padding-right: 10px;"></i>
          <h5 style="margin-bottom: 0;">Installation Instructions</h5>
      </div>
      <div class="flex flex-row">
          <p style="color:#444; margin-bottom: 6px;">Click here to see how to install and configure the BVSDK.</p>
      </div>
      <div style="clear:both;"></div>
    </a>
  </div>
  <div id="installationCollapse" class="panel-collapse collapse " role="tabpanel" aria-labelledby="headingOne">
    <div class="panel-body">

<h3>Installation with Gradle</h3>
<p>Include the Maven Central repository and add the appropriate Bazaarvoice Mobile SDK modules to your dependencies:</p>


<pre><code>dependencies {
    compile 'com.bazaarvoice.bvandroidsdk:location:6.+'
    compile 'com.google.android.gms:play-services-ads:9.{your_play_services_version}'
    compile 'com.android.support:recyclerview-v7:25.{your_support_library_version}'
    compile 'com.android.support:support-v4:25.{your_support_library_version}'
    compile 'com.android.support:appcompat-v7:25.{your_support_library_version}'
}
repositories {
    mavenCentral()
} </code></pre>



<br>

<h3>Extending the Application</h3>
<p>Create a class that extends <code>android.app.Application</code>, and initialize the Mobile SDK using its builder.</p>
<p>You can find a full list of build options in <code>BVSDK.java</code>.</p>
<p>in the following example, <code>YOUR_CLIENT_ID</code> represents your client name, such as "<strong>bazaarvoice</strong>". If you are unsure about your client ID or API key values, contact <a href="https://developer.bazaarvoice.com/support">Client Care</a> or your implementation team.</p>

<pre><code class="java">public class MyApplication extends Application {

    @Override
    public void onCreate(){
        super.onCreate();
        BVSDK.builder(application, BazaarEnvironment.PRODUCTION)
          .logLevel(BVLogLevel.VERBOSE) // Optional: Set the log level. Default level is ERROR.
          .dryRunAnalytics(false)       // Optional: Set analytics to log only, not make a network request. Default is false.
          .okHttpClient(okHttpClient)   // Optional: Use you own okHttpClient instance
          .build();
    }
}
</code></pre>
<br>

<h3>AndroidManifest</h3>
<hr>
<pre><code class="xml">&lt;!-- set the name of the class for the application entry --&gt;
&lt;application
    android:name=".MyApplication"&gt;
&lt;/application&gt;</code></pre>


		</div>
    </div>
  </div>
<br>


<h2>Using the Location Module</h2>
<br>
<h4>Requesting User Location Permission</h4>
<p>You will need to obtain fine location permission. The Location module cannot function without this. This permission is included in the Location module's manifest, but please note that your app might need to support Runtime Permissions for obtaining fine location. Please follow best practices when requesting permission at Runtime. Request it at a time when it's contexually relavent such as when trying to use a "Store Finder." Ask via your own dialog first then present the actual system prompt if they accepted your prompt. This way you can provide the detailed benefits they'd receive if they grant the permission. There are many online resources you refer to when making you permission request decisions.
</p>

<br>
<h4>Listening for Location Events in the background</h4>

<p>Once location permissions have been accepted you can now begin listening for geofence notifications.
    In order to do be listening even when the app has been backgrounded and/or killed you should implement
    your own Service which then sets up location listeners with the BVLocationManager. Make sure to add the
    new Service to your Manifest.</p>

<pre><code class="xml">&lt;manifest&gt;
    &lt;application&gt;
        &lt;service
                android:name="com.mycompany.myapp.DemoLocationService"
                android:exported="false" /&gt;
    &lt;/application&gt;
&lt;/manifest&gt;</code></pre>

<pre><code class="java">public class DemoLocationService extends Service {
    @Override
    public void onCreate() {
        super.onCreate();
        BVLocationManager.getInstance().startMonitoringLocation();
    }

    @Override
    public void onDestroy() {
        BVLocationManager.getInstance().stopMonitoringLocation();
        super.onDestroy();
    }

    @Nullable
    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }
}</code></pre>

<br>
<h4>Listening for when your Users Enter/Exit your Locations</h4>

<p>In order to be notified when a user enter/exits a store you should add a BVLocationManager.BVLocationListener
to your service.</p>

<pre><code class="java">public class DemoLocationService extends Service {
    public static final String ACTION_VISIT_START = "com.mycompany.myapp.action.VISIT_START";
    public static final String ACTION_VISIT_END = "com.mycompany.myapp.action.VISIT_END";

    public static final String EXTRA_STORE_ID = "extra_store_id";

    private BVLocationManager.BVLocationListener bvLocationListener = new BVLocationManager.BVLocationListener() {
        @Override
        public void didBeginVisit(BVVisit visit) {
            Intent intent = new Intent(ACTION_VISIT_START);
            intent.putExtra(EXTRA_STORE_ID, visit.getStoreId());
            sendBroadcast(intent);
        }

        @Override
        public void didEndVisit(BVVisit visit) {
            Intent intent = new Intent(ACTION_VISIT_END);
            intent.putExtra(EXTRA_STORE_ID, visit.getStoreId());
            sendBroadcast(intent);
        }
    };

    @Override
    public void onCreate() {
        super.onCreate();
        BVLocationManager.getInstance().addLocationVisitListener(bvLocationListener);
        BVLocationManager.getInstance().startMonitoringLocation();
    }

    @Override
    public void onDestroy() {
        BVLocationManager.getInstance().stopMonitoringLocation();
        BVLocationManager.getInstance().removeLocationVisitListener(bvLocationListener);
        super.onDestroy();
    }

    @Nullable
    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }

}</code></pre>

<p>Once you have setup your service, you are now ready to begin listening for the broadcasts
that you send from it. Below is an example of an Activity which has it's own inner BroadcastReceiver
which is listening for the custom events we made above. You could implement your own standalone
BroadcastReceiver as well that is registered in the AndroidManifest.xml if you wished to have your
app always listening for your custom broadcasts.</p>

<pre><code class="java">public class DemoLocationActivity extends AppCompatActivity {
    private BroadcastReceiver demoLocationReceiver = new BroadcastReceiver() {
        @Override
        public void onReceive(Context context, Intent intent) {
            if (intent.getAction() != null) {
                switch (intent.getAction()) {
                    case DemoLocationService.ACTION_VISIT_START: {
                        String storeId = intent.getStringExtra(DemoLocationService.EXTRA_STORE_ID);
                        updateLastLocEvent("visit start for " + storeId);
                        break;
                    }
                    case DemoLocationService.ACTION_VISIT_END: {
                        String storeId = intent.getStringExtra(DemoLocationService.EXTRA_STORE_ID);
                        updateLastLocEvent("visit end for " + storeId);
                        break;
                    }
                }
            }
        }
    };

    private void updateLasLocEvent(String lastLocEvent) {
        // ...
    }
}</code></pre>

<br>
<h4>Listening for when your user taps review notification</h4>

<p>In order to be notified when a user has tapped a notification, asking to review a product, you should
add a BVLocationManager.BVRateStoreListener to your service.</p>

<pre><code class="java">public class DemoLocationService extends Service {
    public static final String ACTION_RATE_STORE = "com.bazaarvoice.bvsdkdemoandroid.action.RATE_STORE";

    public static final String EXTRA_STORE_ID = "extra_store_id";

    private BVLocationManager.BVRateStoreListener rateStoreListener = new BVLocationManager.BVRateStoreListener() {
        @Override
        public void onRateStoreClicked(String storeId) {
            Intent intent = new Intent(ACTION_RATE_STORE);
            intent.putExtra(EXTRA_STORE_ID, storeId);
            sendBroadcast(intent);
        }
    };

    @Override
    public void onCreate() {
        super.onCreate();
        BVLocationManager.getInstance().addRateStoreListener(rateStoreListener);
        BVLocationManager.getInstance().startMonitoringLocation();
    }

    @Override
    public void onDestroy() {
        BVLocationManager.getInstance().stopMonitoringLocation();
        BVLocationManager.getInstance().removeRateStoreListener(rateStoreListener);
        super.onDestroy();
    }

    @Nullable
    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }

}</code></pre>

<p>Once you have setup your service, you are now ready to begin listening for the broadcasts
    that you send from it. Below is an example of an Activity which has it's own inner BroadcastReceiver
    which is listening for the custom events we made above. You could implement your own standalone
    BroadcastReceiver as well that is registered in the AndroidManifest.xml if you wished to have your
    app always listening for your custom broadcasts.</p>

<pre><code class="java">public class DemoLocationActivity extends AppCompatActivity {
    private BroadcastReceiver demoLocationReceiver = new BroadcastReceiver() {
        @Override
        public void onReceive(Context context, Intent intent) {
            if (intent.getAction() != null) {
                switch (intent.getAction()) {
                    case DemoLocationService.ACTION_RATE_STORE: {
                        String storeId = intent.getStringExtra(DemoLocationService.EXTRA_STORE_ID);
                        updateLastLocEvent("user tapped rate store for " + storeId);
                        break;
                    }
                }
            }
        }
    };

    private void updateLasLocEvent(String lastLocEvent) {
        // ...
    }
}</code></pre>
<br>



<div class="well well-sm">
	<h5>Author</h5>
	<p>Copyright 2017 Bazaarvoice, Inc. All rights reserved.</p>
	<h5>License</h5>
	<p>Use of the Bazaarvoice Mobile SDKs is contingent on your agreement and conformance with <a href="http://www.bazaarvoice.com/legal/api-terms-of-use.html">Bazaarvoice's API Terms of Use</a>. Additionally, you agree to store all data acquired by the SDK or Bazaarvoice's API only within the storage of the individual application instance using the SDK or API. You also agree to use the data acquired by the SDK or API only within the context of the same individual application instance and only for purposes consistent with that application's purpose. Except as otherwise noted, the Bazaarvoice Android and iOS SDKs are licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache License, Version 2.0</a>.</p>
</div>
<br>


              </div>
            </div>
          </div>
        </div>        
      </div>
    </div>
  </body>
